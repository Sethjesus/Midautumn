<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>🎑 中秋快樂 ESG 動態賀卡</title>
<style>
  body{margin:0;font-family:"Microsoft JhengHei",sans-serif;background:#0b1d3a;color:#fff;text-align:center;overflow-x:hidden;position:relative}

  /* Header */
  header{padding:20px 80px 10px 20px;font-size:2em;font-weight:bold;color:#ffd700;position:relative;z-index:10}

  /* ── Logo 連結 + 動態與提示（膠囊於 Logo 下方；手指向上） ── */
  header a.logo-link{position:absolute;right:20px;top:10px;text-align:center;text-decoration:none}
  header img.logo{height:50px;animation:pulseLogo 2.5s infinite ease-in-out;transform-origin:center;display:block;margin:auto;cursor:pointer}
  @keyframes pulseLogo{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
  header .hint{
    display:inline-block;margin-top:6px;padding:4px 12px;font-size:.82em;color:#0b1d3a;
    background:linear-gradient(135deg,#ffefb2,#ffc157);
    border-radius:999px;box-shadow:0 0 8px rgba(255,205,110,.75), 0 0 18px rgba(255,205,110,.35);
    animation:glowHint 1.6s infinite alternate;transition:transform .2s ease, box-shadow .2s ease; white-space:nowrap;
  }
  header a.logo-link:hover .hint{transform:translateY(-1px) scale(1.06);box-shadow:0 0 14px rgba(255,220,140,1), 0 0 28px rgba(255,220,140,.55)}
  @keyframes glowHint{0%{opacity:.75}100%{opacity:1}}

  .blessing{margin:8px auto 20px;font-size:1.1em;line-height:1.6em;max-width:900px;color:#ffea85;position:relative;z-index:10}

  /* Slideshow */
  .slideshow{position:relative;max-width:900px;height:520px;margin:0 auto;overflow:hidden;border-radius:16px;
    box-shadow:0 0 20px rgba(255,255,255,.3);display:grid;place-items:center;
    background:radial-gradient(ellipse at center, rgba(255,255,255,.06), rgba(0,0,0,0));z-index:10}
  .slideshow img{position:absolute;inset:0;margin:auto;max-width:100%;max-height:100%;width:auto;height:auto;object-fit:contain;opacity:0;transition:opacity 1s ease-in-out}
  .slideshow img.active{opacity:1}

  .caption{margin:14px auto 0;min-height:32px;font-size:1.25em;color:#ffde59;transition:opacity .5s ease;position:relative;z-index:10}
  .caption.fade{opacity:0}

  /* Quiz */
  .quiz{margin:32px auto 80px;max-width:720px;background:rgba(255,255,255,.1);padding:20px;border-radius:12px;position:relative;z-index:10}
  .quiz h2{margin-bottom:16px;color:#ffd700}
  .question{margin-bottom:18px;text-align:left}
  .question p{margin:6px 0}
  button{background:#ffd700;border:none;border-radius:6px;padding:8px 16px;margin:4px;cursor:pointer;font-size:1em;color:#222;font-weight:bold}
  button:hover{background:#ffea85}
  .result{margin-top:20px;font-size:1.2em;font-weight:bold}

  /* ✅ 靜音切換鈕：深藍底＋白字（hover 亮藍＋淡金字），只控制答題音效，不影響背景音樂 */
  .muted-toggle{
    position:fixed;right:16px;bottom:16px;background:#0b1d3a;color:#ffffff;border:1px solid #ffd700;
    padding:8px 12px;border-radius:8px;font-size:.95em;cursor:pointer;z-index:20;
    box-shadow:0 0 6px rgba(255,215,0,.4);transition:all .25s ease;
  }
  .muted-toggle:hover{background:#1e3a8a;color:#ffde59;box-shadow:0 0 12px rgba(255,215,0,.7)}

  /* --- 牛郎織女背景層（最底） + 裝飾層 --- */
  #qixi-bg{position:fixed; inset:0; z-index:0; pointer-events:none; opacity:.22}
  #decorations{position:fixed; inset:0; z-index:1; pointer-events:none}

  /* 星空 */
  .star{position:absolute;background:#fff;border-radius:50%;opacity:.8;animation:twinkle 2s infinite ease-in-out}
  @keyframes twinkle{0%,100%{opacity:.2}50%{opacity:1}}

  /* 月亮（乾淨） + 月暈 */
  .moon{position:absolute;top:10%;left:-150px;width:120px;height:120px;background:radial-gradient(circle at 30% 30%, #fff9c4, #fdd835);
    border-radius:50%;box-shadow:0 0 30px rgba(255,240,200,.8);animation:moveMoon 60s linear infinite;z-index:1; opacity:.55}
  .moon::after{
    content:""; position:absolute; inset:-25px; border-radius:50%;
    background:radial-gradient(circle, rgba(255,230,140,.28), rgba(255,230,140,0) 60%);
    animation:pulse 4.5s ease-in-out infinite;
  }
  @keyframes moveMoon{from{left:-150px;top:15%}50%{left:50%;top:5%}to{left:110%;top:12%}}
  @keyframes pulse{0%,100%{opacity:.35; transform:scale(1)}50%{opacity:.55; transform:scale(1.08)}}

  /* 雲彩（更淡） */
  .cloud{position:absolute;background:rgba(255,255,255,.32);border-radius:50%;filter:blur(10px);animation:moveClouds linear infinite; z-index:2}
  @keyframes moveClouds{from{transform:translateX(-200px)}to{transform:translateX(120vw)}}

  /* 放射狀煙火火花（滿分觸發） */
  .firework{position:absolute;width:4px;height:4px;border-radius:50%;opacity:0;animation:shoot 1.2s ease-out forwards}
  @keyframes shoot{0%{transform:translate(0,0) scale(1);opacity:1}80%{opacity:1}100%{transform:translate(var(--x),var(--y)) scale(.8);opacity:0}}

  /* 桂花花瓣 */
  .petal{
    position:fixed; top:-20px; left:0;
    width:10px; height:8px; border-radius:8px 8px 6px 6px / 8px 8px 4px 4px;
    background:linear-gradient(145deg,#ffd87a,#ffb347);
    box-shadow:0 0 6px rgba(255,210,120,.6);
    opacity:.9;
    animation:fall var(--dur) linear infinite, sway 3.6s ease-in-out infinite;
  }
  @keyframes fall { to { transform: translateY(110vh) translateX(var(--drift)); } }
  @keyframes sway { 0%,100%{ transform:rotate(0deg) } 50%{ transform:rotate(18deg) } }

  /* 掛燈串（上緣小掛燈輕微擺動） */
  .hang{ position:fixed; top:6px; left:50%; transform:translateX(-50%); width:80%; height:0; z-index:12; pointer-events:none;}
  .hang .dot{
    position:absolute; top:0; width:18px; height:18px; border-radius:50%;
    background:radial-gradient(circle at 35% 35%, #fff1b8, #ffbd4a 60%, #d97b00 100%);
    box-shadow:0 0 12px rgba(255,200,120,.9);
    transform-origin:top center; animation:swing 4s ease-in-out infinite;
  }
  .hang .line{
    position:absolute; top:-12px; width:2px; height:14px; background:rgba(255,230,160,.7);
    left:9px; transform-origin:top; animation:swing 4s ease-in-out infinite;
  }
  @keyframes swing{0%,100%{transform:rotate(-3deg)}50%{transform:rotate(3deg)}}

  /* 喜鵲橋金色光點閃爍 */
  .bridge-lights circle{opacity:.4;animation:twinkleLight 2s infinite alternate}
  .bridge-lights circle:nth-child(2){animation-delay:.4s}
  .bridge-lights circle:nth-child(3){animation-delay:.8s}
  .bridge-lights circle:nth-child(4){animation-delay:1.2s}
  .bridge-lights circle:nth-child(5){animation-delay:1.6s}
  .bridge-lights circle:nth-child(6){animation-delay:2s}
  @keyframes twinkleLight{from{opacity:.3;r:2}to{opacity:1;r:3}}

  /* 手機：讓 header 撐高、縮小膠囊並自動淡出避免擋字 */
  @media (max-width: 480px){
    header{
      font-size: 1.55em;
      padding-right: 90px;   /* 給右上 logo 空間 */
      padding-bottom: 56px;  /* 讓 header 撐高，不壓到下方內容 */
    }
    header a.logo-link{ top:8px; right:12px; }
    header .hint{ font-size:.72em; padding:2px 8px; margin-top:4px; }
    header .hint.auto-hide{
      animation: glowHint 1.6s infinite alternate, fadeOutHint .8s ease 4s forwards;
    }
    @keyframes fadeOutHint{
      to { opacity: 0; transform: translateY(-2px) scale(.96); }
    }
    .slideshow{ height:440px; }
    .moon{ opacity:.38; width:96px; height:96px; }
    .moon::after{ opacity:.22; }
    .cloud{ opacity:.22; }
    .blessing{ padding:0 12px; }
  }
</style>
</head>
<body>
  <header>
    🌕 中秋快樂 · 永續守護地球 🌏
    <a href="https://jpesg.netlify.app/" target="_blank" class="logo-link" aria-label="前往 UDM ESG 官網（另開新視窗）">
      <img src="Logo.png" class="logo" alt="公司Logo" />
      <span class="hint">👆 請按我</span>
    </a>
  </header>

  <button class="muted-toggle" id="muteBtn">🔈 答題音效：開</button>

  <div class="blessing">
    景煬祝您和家人中秋團圓，幸福美滿 🎑<br/>
    明月千里寄相思，清風送來平安喜樂 🍵<br/>
    願我們在享受團聚的同時，也一同守護環境、守護地球 🌍<br/>
    🌸 中秋佳節快樂！
  </div>

  <!-- Slideshow -->
  <div class="slideshow" id="slideshow">
    <img src="01_current_detection.png" class="active" alt="能源偵測"/>
    <img src="02_air_wind.png" alt="清新空氣"/>
    <img src="03_water_river.png" alt="溪河水文"/>
    <img src="04_transport_bike.png" alt="綠色交通"/>
    <img src="06_midautumn_moon.png" alt="中秋明月"/>
    <img src="07_hands_earth.png" alt="守護地球"/>
  </div>
  <div class="caption" id="caption">UDM ESG 景煬 祝您中秋快樂、闔家安康 🎑</div>

  <!-- Quiz -->
  <div class="quiz">
    <h2>🌱 ESG 小問答</h2>
    <div class="question">
      <p>1️⃣ 中秋節最環保的活動是？</p>
      <button onclick="checkAnswer(this,true)">賞月、品茶</button>
      <button onclick="checkAnswer(this,false)">大量燒炭烤肉</button>
    </div>
    <div class="question">
      <p>2️⃣ 為什麼要監測工廠或大樓的電力使用？</p>
      <button onclick="checkAnswer(this,true)">找出節能空間，降低成本與碳排</button>
      <button onclick="checkAnswer(this,false)">只是好玩，沒有實際效益</button>
    </div>
    <div class="question">
      <p>3️⃣ 即時電流/功率監測對環保有什麼幫助？</p>
      <button onclick="checkAnswer(this,true)">及早發現異常與浪費，避免不必要耗能</button>
      <button onclick="checkAnswer(this,false)">與環保無關</button>
    </div>
    <div class="question">
      <p>4️⃣ 哪種做法最能降低電費與碳排？</p>
      <button onclick="checkAnswer(this,true)">使用高效率設備並監控尖離峰用電</button>
      <button onclick="checkAnswer(this,false)">所有機器 24 小時全速運轉</button>
    </div>
    <div class="question">
      <p>5️⃣ kWh（度電）代表什麼？</p>
      <button onclick="checkAnswer(this,true)">用電量（功率 × 時間）</button>
      <button onclick="checkAnswer(this,false)">電壓的單位</button>
    </div>
    <div class="question">
      <p>6️⃣ 以排放係數 ~0.495 kgCO₂e/kWh 計，今天用電 10 kWh 約排放多少？</p>
      <button onclick="checkAnswer(this,true)">約 4.95 kgCO₂e</button>
      <button onclick="checkAnswer(this,false)">約 0.495 kgCO₂e</button>
      <button onclick="checkAnswer(this,false)">約 49.5 kgCO₂e</button>
    </div>
    <div class="question">
      <p>7️⃣ 下面哪項最能立刻降低待機耗電？</p>
      <button onclick="checkAnswer(this,true)">使用有開關延長線，離開時關閉待機</button>
      <button onclick="checkAnswer(this,false)">螢幕亮度調到最亮</button>
    </div>
    <div class="result" id="result"></div>
  </div>

  <!-- 牛郎織女相會（最底層 SVG；含 Logo 星座排列＋喜鵲橋光點） -->
  <svg id="qixi-bg" viewBox="0 0 1000 600" preserveAspectRatio="xMidYMid slice" aria-hidden="true">
    <defs>
      <!-- 銀河 -->
      <linearGradient id="milky" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0%" stop-color="#7fc7ff" stop-opacity="0.08"/>
        <stop offset="50%" stop-color="#d6e9ff" stop-opacity="0.26"/>
        <stop offset="100%" stop-color="#7fc7ff" stop-opacity="0.08"/>
      </linearGradient>
      <!-- 月暈柔光 -->
      <radialGradient id="glow" cx="50%" cy="50%" r="50%">
        <stop offset="0%" stop-color="#ffe6a0" stop-opacity="0.35"/>
        <stop offset="100%" stop-color="#ffe6a0" stop-opacity="0"/>
      </radialGradient>
      <!-- 喜鵲 -->
      <symbol id="magpie" viewBox="-6 -5 12 10">
        <path d="M-5,0 L0,-4 L5,0 L0,2 Z" fill="#ffd08a" fill-opacity=".65"/>
        <circle cx="0" cy="1.2" r="1.2" fill="#ffd08a" fill-opacity=".75"/>
      </symbol>
    </defs>

    <!-- 銀河：對角柔光帶 -->
    <g transform="rotate(-25 500 300)">
      <rect x="-100" y="150" width="1200" height="140" fill="url(#milky)"/>
      <rect x="100" y="170" width="800" height="100" fill="url(#milky)" opacity=".5"/>
    </g>

    <!-- 月暈柔光（背景） -->
    <circle cx="160" cy="90" r="120" fill="url(#glow)"/>

    <!-- 喜鵲橋（底下拱線） -->
    <path d="M140,390 C300,300 700,300 860,390" fill="none" stroke="#ffd08a" stroke-opacity=".22" stroke-width="16"/>
    <path d="M160,380 C310,310 690,310 840,380" fill="none" stroke="#ffd08a" stroke-opacity=".35" stroke-width="6"/>

    <!-- 喜鵲排成橋 -->
    <g opacity=".9">
      <use href="#magpie" x="200" y="360" transform="rotate(-12 200 360)"/>
      <use href="#magpie" x="245" y="345" transform="rotate(-10 245 345)"/>
      <use href="#magpie" x="285" y="332" transform="rotate(-8 285 332)"/>
      <use href="#magpie" x="325" y="322" transform="rotate(-6 325 322)"/>
      <use href="#magpie" x="365" y="314" transform="rotate(-4 365 314)"/>
      <use href="#magpie" x="405" y="308" transform="rotate(-2 405 308)"/>
      <use href="#magpie" x="445" y="305" transform="rotate(0 445 305)"/>
      <use href="#magpie" x="485" y="304" transform="rotate(2 485 304)"/>
      <use href="#magpie" x="525" y="305" transform="rotate(4 525 305)"/>
      <use href="#magpie" x="565" y="309" transform="rotate(6 565 309)"/>
      <use href="#magpie" x="605" y="315" transform="rotate(8 605 315)"/>
      <use href="#magpie" x="645" y="323" transform="rotate(10 645 323)"/>
      <use href="#magpie" x="685" y="334" transform="rotate(12 685 334)"/>
      <use href="#magpie" x="730" y="348" transform="rotate(14 730 348)"/>
    </g>

    <!-- 橋上金色光點（對應 CSS 動畫 .bridge-lights） -->
    <g class="bridge-lights">
      <circle cx="220" cy="352" r="2" fill="#ffd97a"/>
      <circle cx="300" cy="334" r="2" fill="#ffd97a"/>
      <circle cx="420" cy="312" r="2" fill="#ffd97a"/>
      <circle cx="540" cy="306" r="2" fill="#ffd97a"/>
      <circle cx="660" cy="320" r="2" fill="#ffd97a"/>
      <circle cx="780" cy="346" r="2" fill="#ffd97a"/>
    </g>

    <!-- 牛郎織女剪影＋更細漢服裙擺 -->
    <g fill="#ffe0b6" fill-opacity=".9" stroke="none">
      <!-- 牛郎 -->
      <circle cx="460" cy="330" r="10" fill-opacity=".9"/>
      <rect x="455" y="340" width="10" height="24" rx="3" fill-opacity=".9"/>
      <!-- 織女 -->
      <circle cx="540" cy="330" r="10" fill-opacity=".95"/>
      <rect x="535" y="340" width="10" height="24" rx="3" fill-opacity=".95"/>
    </g>
    <g fill="#ffe0b6" fill-opacity=".55" stroke="#ffd9a0" stroke-opacity=".35" stroke-width="1">
      <!-- 牛郎衣襬 -->
      <path d="M450,362 C458,356 467,356 475,362 C470,372 455,372 450,362 Z"/>
      <!-- 織女長裙（主裙） -->
      <path d="M525,364 C 532,356 548,356 555,366 C 560,380 548,392 540,395 C 532,392 520,380 525,364 Z"/>
      <!-- 織女外層裙擺（飄逸層） -->
      <path d="M520,366 C 532,360 551,360 560,372 C 562,384 550,398 538,402 C 526,398 516,384 520,366 Z" fill-opacity=".35"/>
      <!-- 飄帶 -->
      <path d="M548,338 C570,328 590,330 610,344" fill="none" stroke="#ffe6be" stroke-opacity=".5" stroke-width="2"/>
      <path d="M545,344 C565,336 585,338 600,352" fill="none" stroke="#ffe6be" stroke-opacity=".45" stroke-width="1.6"/>
    </g>

    <!-- Logo 星座排列（U-D-M 三點；可依實際 Logo 幾何微調） -->
    <g fill="#fff" fill-opacity=".9" stroke="#bfe1ff" stroke-opacity=".55" stroke-width="1.2">
      <circle cx="760" cy="90"  r="2.3"/>
      <circle cx="800" cy="130" r="2.3"/>
      <circle cx="780" cy="180" r="2.3"/>
      <line x1="760" y1="90"  x2="800" y2="130"/>
      <line x1="800" y1="130" x2="780" y2="180"/>
      <line x1="780" y1="180" x2="760" y2="90"/>
    </g>

    <!-- 柔光雲霧，讓星座更自然 -->
    <g opacity=".18">
      <ellipse cx="820" cy="150" rx="90" ry="40" fill="#cfe8ff"/>
      <ellipse cx="790" cy="210" rx="70" ry="28" fill="#cfe8ff"/>
    </g>
  </svg>

  <!-- 裝飾層（星空/雲/流星/花瓣） -->
  <div id="decorations"></div>
  <div class="moon"></div>

  <!-- 掛燈串 -->
  <div class="hang" id="hang"></div>

  <!-- 古箏風背景音樂（不受靜音按鈕控制） -->
  <audio id="bgm" autoplay loop>
    <source src="https://cdn.pixabay.com/audio/2021/08/04/audio_30a195997c.mp3" type="audio/mpeg"/>
  </audio>

<script>
  /* 圖片與文字輪播 */
  const slides=document.querySelectorAll('.slideshow img');
  const caption=document.getElementById('caption');
  const messages=[
    'UDM ESG 景煬 祝您中秋快樂、闔家安康 🎑',
    '風清氣爽、河川潺潺，願您平安健康 💙',
    '月圓人團圓 · 清風明月伴好眠 🍵',
    '騎車賞月不塞車，綠色交通好自在 🚴',
    '節能減碳、守護地球，讓幸福更長久 🌍',
    '守護地球，中秋垃圾帶回家 ♻️'
  ];
  let current=0,msgIndex=0;
  setInterval(()=>{
    slides[current].classList.remove('active');
    current=(current+1)%slides.length;
    slides[current].classList.add('active');
    caption.classList.add('fade');
    setTimeout(()=>{
      msgIndex=(msgIndex+1)%messages.length;
      caption.textContent=messages[msgIndex];
      caption.classList.remove('fade');
    },400);
  },3000);

  /* 背景樂：嘗試自動播放；若被阻擋，首次互動後播放 */
  const bgm=document.getElementById('bgm');
  (async()=>{try{await bgm.play();}catch(e){}})();
  function enableBgm(){ if(bgm.paused){ bgm.play().catch(()=>{});} window.removeEventListener('click',enableBgm); window.removeEventListener('touchstart',enableBgm); }
  window.addEventListener('click',enableBgm,{once:true});
  window.addEventListener('touchstart',enableBgm,{once:true});

  /* 答題音效（獨立於背景樂） */
  const AudioCTX=window.AudioContext||window.webkitAudioContext;
  let actx=null, muted=false;
  const muteBtn=document.getElementById('muteBtn');
  function initAudio(){ if(!actx) actx=new AudioCTX(); }
  window.addEventListener('click',initAudio,{once:true});

  muteBtn.onclick=()=>{ muted=!muted; muteBtn.textContent=muted?'🔇 答題音效：關':'🔈 答題音效：開'; };

  function tone(freq=880,dur=0.15,type='sine',vol=0.2){
    if(muted||!actx) return;
    const o=actx.createOscillator(), g=actx.createGain();
    o.type=type; o.frequency.value=freq; g.gain.value=vol;
    g.gain.exponentialRampToValueAtTime(0.0001,(actx.currentTime+dur));
    o.connect(g).connect(actx.destination);
    o.start(); o.stop(actx.currentTime+dur);
  }
  function playCorrect(){ tone(1046,0.12,'triangle',0.25); setTimeout(()=>tone(1318,0.12,'triangle',0.22),110); }
  function playWrong(){ tone(220,0.18,'sawtooth',0.25); setTimeout(()=>tone(196,0.2,'sawtooth',0.22),160); }
  function playWin(){ [784,988,1175].forEach((f,i)=>setTimeout(()=>tone(f,0.18,'sine',0.28), i*150)); triggerFireworks(); }

  /* 小遊戲 */
  let score=0,answered=0;
  const totalQuestions=document.querySelectorAll('.question').length;
  function checkAnswer(btn,ok){
    if(btn.classList.contains('answered')) return;
    const box=btn.closest('.question'); if(box.dataset.locked) return; box.dataset.locked='1';
    btn.classList.add('answered'); answered++;
    if(ok){ score++; btn.style.background='#4CAF50'; playCorrect(); }
    else { btn.style.background='#E74C3C'; playWrong(); }
    if(answered>=totalQuestions){
      const result=document.getElementById('result');
      if(score===totalQuestions){ result.innerHTML='🎉 太強了！滿分 '+score+'/'+totalQuestions+'，你是 ESG 守護者！🎑'; triggerFireworks(); }
      else{ result.innerHTML=`完成！得分 ${score}/${totalQuestions}，一起持續節能減碳 🌍`; }
    }
  }
  window.checkAnswer=checkAnswer;

  /* 星空／雲彩（裝飾層在 qixi 之上但仍在底部） */
  const deco=document.getElementById('decorations');
  for(let i=0;i<60;i++){
    const s=document.createElement('div'); s.className='star';
    s.style.width=s.style.height=(Math.random()*2+1)+'px';
    s.style.top=(Math.random()*100)+'%';
    s.style.left=(Math.random()*100)+'%';
    s.style.animationDuration=(2+Math.random()*3)+'s';
    deco.appendChild(s);
  }
  for(let i=0;i<3;i++){
    const c=document.createElement('div'); c.className='cloud';
    c.style.width=(200+Math.random()*150)+'px';
    c.style.height=(80+Math.random()*40)+'px';
    c.style.top=(10+Math.random()*30)+'%';
    c.style.left='-200px';
    c.style.animationDuration=(50+Math.random()*30)+'s';
    deco.appendChild(c);
  }

  /* 掛燈串（等距分布） */
  const hang=document.getElementById('hang');
  for(let i=0;i<10;i++){
    const d=document.createElement('div'); d.className='dot'; d.style.left=(5+i*9)+'%';
    const line=document.createElement('div'); line.className='line'; line.style.left=d.style.left;
    hang.appendChild(line); hang.appendChild(d);
  }

  /* 桂花花瓣 */
  function spawnPetal(){
    const p=document.createElement('div'); p.className='petal';
    p.style.left=Math.random()*100+'%';
    p.style.setProperty('--dur',(8+Math.random()*8)+'s');
    p.style.setProperty('--drift',(Math.random()*160-80)+'px');
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),16000);
  }
  for(let i=0;i<18;i++) setTimeout(spawnPetal, i*400);
  setInterval(spawnPetal, 1200);

  /* 不定時流星 */
  function shootingStar(){
    const star=document.createElement('div');
    star.style.position='fixed';
    star.style.width='2px'; star.style.height='2px';
    star.style.borderRadius='50%'; star.style.background='#fff';
    const x=Math.random()*80+10, y=Math.random()*25+5;
    star.style.left=x+'%'; star.style.top=y+'%';
    star.style.boxShadow='0 0 10px rgba(255,255,255,.9)';
    star.animate([
      { transform:'translate(0,0)', opacity:1, offset:0 },
      { boxShadow:'0 0 20px rgba(255,255,255,1)', offset:.2 },
      { transform:'translate(-140px,120px)', opacity:0, offset:1 }
    ], { duration:1400, easing:'ease-out' });
    document.body.appendChild(star);
    setTimeout(()=>star.remove(),1500);
  }
  setInterval(()=>{ if(Math.random()<0.35) shootingStar(); }, 2200);

  /* 放射狀煙火（滿分觸發） */
  function triggerFireworks(){
    const colors=['#ff0','#f0f','#0ff','#0f0','#f00','#ffa500','#00f'];
    for(let n=0;n<5;n++){
      setTimeout(()=>{
        for(let i=0;i<40;i++){
          const f=document.createElement('div'); f.className='firework';
          f.style.left='50%'; f.style.top='40%';
          const angle=Math.random()*2*Math.PI, dist=80+Math.random()*120;
          f.style.setProperty('--x',`${Math.cos(angle)*dist}px`);
          f.style.setProperty('--y',`${Math.sin(angle)*dist}px`);
          f.style.background=colors[Math.floor(Math.random()*colors.length)];
          document.body.appendChild(f); setTimeout(()=>f.remove(),1300);
        }
      },n*500);
    }
  }

  /* 手機上 4 秒後自動淡出「請按我」膠囊，避免擋到文字 */
  (function(){
    if (window.matchMedia('(max-width: 480px)').matches) {
      const hint = document.querySelector('header .hint');
      if (hint) hint.classList.add('auto-hide');
    }
  })();
</script>
</body>
</html>
